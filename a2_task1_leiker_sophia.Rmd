---
title: "Assignment 2: Task 1"
author: "Sophia Leiker"
date: "1/30/2022"
output: 
  html_document: 
    toc: yes
    code_folding: hide
---

```{r setup, include=TRUE, warning=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

library(tidyverse)
library(here)
library(janitor)
library(lubridate)
library(patchwork)
library(cowplot)
library(GGally)
library(broom)
library(jtools)
library(caret)
library(AICcmodavg)
library(ggbeeswarm)
```


## 1. Introduction

This report will employ binary logistic regression to test feasibility of using variables plant height (height), canopy length (length), canopy width (width), and number of green leaves (green_lvs) to classify whether a palmetto is species Serenoa repens or Sabal etonia.

The analysis will be performed twice, and will use cross validation to compare two models:

- Log odds of plant type using plant height, canopy length, canopy width and green leaves as predictor variable.
- Log odds of plant type using plant height, canopy width and green leaves (i.e., drop canopy length for this model)


**Data Source:** The data used comes from: [Abrahamson, W.G. 2019. Survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017, ongoing at 5-year intervals ver 1. Environmental Data Initiative](https://doi.org/10.6073/pasta/f2f96ec76fbbd4b9db431c79a770c4d5) and metadata, including methods used for data collection can be found here [EDI Data Portal](https://portal.edirepository.org/nis/metadataviewer?packageid=edi.317.1).
The first dataset, palmetto_data, contains survival and growth data across multiple years, habitats and experimental treatments. The second dataset, seedlings_data, follows the fate of marked putative palmetto seedlings in the field to assess survivorship and growth. The final dataset, harvested_palmetto_data, contains size data and estimated dry mass (biomass in grams) of 33 destructively harvested palmetto plants (17 S. repens and 16 S. etonia) of varying sizes and across habitats.



```{r}
# Reading in the data
palmetto <- read_csv(here("data", "palmetto.csv")) %>% 
  clean_names()

```

***


## 2. Data Exploration and Visualization

- Exploring differences in height, canopy length, canopy width, and green leaves for the two species
- `height` = maximum height 1981-2017 [cm]
- `length` = widest length of the canopy 1981-2017 [cm]
- `width` = widest width of the canopy perpendicular to the canopy length 1981-2017 [cm]
- `green_lvs` = count of green leaves 1981-2017 [dimensionless]
- Assessing what predictor variables might be best used for classification
- `species` column: 1 = Serenoa repens, 2 = Sabal etonia

### A. Cleaning up the data
- Rename to easily identify Serenoa repens to Sabal etonia
- Selecting only the columns of interest 

```{r}
palmetto_clean <- palmetto %>% 
  select("species", "height", "length", "width", "green_lvs")

palmetto_clean$species[palmetto_clean$species == 1] <- "repens"
palmetto_clean$species[palmetto_clean$species == 2] <- "etonia"


```

```{r eval=FALSE}
#Evaluating via ggpairs, eval = FALSE after visually assessing trends
palmetto_clean %>% 
  select(species, height:green_lvs) %>% 
  ggpairs(aes(color=species))

#seems like there are differences in green_lvs
#slight difference in height and length
#not much difference in width

```

### B. Visualizing the Data

- Exploring differences in height, canopy length, canopy width, and green leaves for the two species
- Working to determine which predictor variables are more likely to help classify species correctly


```{r}
#Plotting Width
plot1 <- ggplot(data = palmetto_clean, aes(x = species, y = width)) +
  geom_beeswarm(cex = 2, aes(color = species)) +
  theme_minimal() +
  labs(x = "Species", y = "Width (cm)", title = "Canopy  Width S. repens, S. etonia", subtitle = "Data from: Abrahamson, W.G. 2019") +
  guides(fill = guide_legend(title = "Species")) +
  geom_boxplot(fill = NA, width = 0.4, outlier.color = NA) +
    theme(axis.ticks.x = element_blank(),
        axis.text.x = element_blank()) +
   scale_color_manual(values = c("steelblue1", "tan1"))
```

```{r}
#Plotting Height
plot2 <- ggplot(data = palmetto_clean, aes(x = species, y = height)) +
  geom_beeswarm(cex = 2, aes(color = species)) +
  theme_minimal() +
  labs(x = "Species", y = "Canopy Height (cm)", title = "Canopy Height S. repens, S. etonia", subtitle = "Data from: Abrahamson, W.G. 2019") +
  guides(fill = guide_legend(title = "Species")) +
  geom_boxplot(fill = NA, width = 0.4, outlier.color = NA) +
    theme(axis.ticks.x = element_blank(),
        axis.text.x = element_blank()) +
   scale_color_manual(values = c("steelblue1", "tan1"))
```

```{r}
#Plotting Length
plot3 <- ggplot(data = palmetto_clean, aes(x = species, y = length)) +
  geom_beeswarm(cex = 2, aes(color = species)) +
  theme_minimal() +
  labs(x = "Species", y = "Length (cm)", title = "Canopy Length S. repens, S. etonia", subtitle = "Data from: Abrahamson, W.G. 2019") +
  guides(fill = guide_legend(title = "Species")) +
  geom_boxplot(fill = NA, width = 0.4, outlier.color = NA) +
  theme(axis.ticks.x = element_blank(),
        axis.text.x = element_blank()) +
  scale_color_manual(values = c("steelblue1", "tan1"))
```

**Visualizing Individual Variables Between Species** 
```{r}
plot_grid(plot1, plot2, plot3, labels = c("A.", "B.", "C."), label_size = 20)
```

**Figure 1**: Spread of individual data points for the variables width, height, and length for Serenoa repend (orange) vs Sabtal etonia (blue). A) Illustrates canopy width as the widest width of the canopy perpendicular to the canopy length 1981-2017 [cm] between the two species, B) Illustrates maximum height 1981-2017 [cm] between the two species. C) Illustrates widest length of the canopy 1981-2017 [cm]. Green leaf spread is analyzed below.

**Visualizing Variable Relationships (multiple variables)**

```{r}
ggplot(data = palmetto_clean, aes(x = length, y = width)) +
  geom_point(aes(color = species)) +
  theme_minimal() +
  labs(x = "Length (cm)", y = "Width (cm)", title = "Canopy Length and Width for Serenoa repens vs Sabal etonia", subtitle = "Data from: Abrahamson, W.G. 2019") +
  scale_color_manual(values = c("steelblue1", "tan1"))
```

**Figure 2**: Relationship between canopy length and canopy width for Serenoa repend (orange) vs Sabtal etonia (blue).

```{r}
ggplot(data = palmetto_clean, aes(x = height, y = green_lvs)) +
  geom_point(aes(color = species)) +
  theme_minimal() +
  labs(x = "Height (cm)", y = "Green Leaves (count)", title = "Canopy Height and Green Leaves Count for Serenoa repens vs Sabal etonia", subtitle = "Data from: Abrahamson, W.G. 2019") +
  scale_color_manual(values = c("steelblue1", "tan1"))

```

**Figure 3**: Relationship between canopy height and green leaves for Serenoa repend (orange) vs Sabtal etonia (blue).

```{r}
ggplot(data = palmetto_clean, aes(x = length, y = green_lvs)) +
  geom_point(aes(color = species)) +
  theme_minimal() +
  labs(x = "Length (cm)", y = "Green Leaves (count)", title = "Length and Green Leaves Count for Serenoa repens vs Sabal etonia", subtitle = "Data from: Abrahamson, W.G. 2019") +
  scale_color_manual(values = c("steelblue1", "tan1"))
```

**Figure 4**: Relationship between canopy length and green leaves for Serenoa repend (orange) vs Sabtal etonia (blue).

A section containing 2 - 3 finalized (customized, suitable for a publication) data visualizations (with figure captions) in which you explore differences in height, canopy length, canopy width, and green leaves for the two species. If you prefer, combine the figures into a compound figure using {patchwork} or {cowplot}. Below your data visualizations, add a sentence or two with a takeaway from the plots, e.g., based on these plots, which predictor variables are more likely to help classify species correctly?

**Overall Takeaways**: The variables that are most likely to help classify species seem to be first and most clearly, the leaf count, followed by height and then length, and lastly width. There seems to be significant overlap in canopy width which indicates that is may not be an ideal candidate to help separate out species. 

***

## 3. Binary Logistic Regression

```{r}
#Converting to factor

palmetto_clean2<- palmetto %>% 
  select("species", "height", "length", "width", "green_lvs")

palmetto_clean2 <- as.factor(palmetto_clean2$species)
#mutate species name = speciesname(as.factor)
#case when 


```


### A. Log odds of plant type using plant height, canopy length, canopy width and green leaves as predictor variables


```{r}

```


### B. Log odds of plant type using plant height, canopy width and green leaves








## X. Data Citation

Data source: Abrahamson, W.G. 2019. Survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017, ongoing at 5-year intervals ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/f2f96ec76fbbd4b9db431c79a770c4d5